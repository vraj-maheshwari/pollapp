<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Create Poll</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-7">
        <div class="card shadow-sm">
          <div class="card-header bg-primary text-white text-center">
            <h4 class="mb-0">Create a Poll</h4>
          </div>
          <div class="card-body">
            <form method="post" id="pollForm">
              <div class="mb-3">
                <label for="question" class="form-label">Poll question</label>
                <input type="text" id="question" name="question" class="form-control" maxlength="120" required placeholder="Type your question">
                <div id="autoSplitInfo" class="form-text text-success d-none">Auto-splitting choices detected.</div>
              </div>

              <div id="manualOptions">
                <div class="mb-2">
                  <label class="form-label">Number of options</label>
                  <select name="num_options" id="num_options" class="form-select w-auto" onchange="showOptions()">
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                  </select>
                </div>
                <div id="options"></div>
              </div>

              <div class="form-check my-3">
                <input class="form-check-input" type="checkbox" id="hide_results" name="hide_results">
                <label class="form-check-label" for="hide_results">Hide results until user votes</label>
              </div>

              <button type="submit" class="btn btn-primary w-100">Create Poll</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const qInput = document.getElementById('question');
const info = document.getElementById('autoSplitInfo');
const manual = document.getElementById('manualOptions');
qInput.addEventListener('input', () => {
  const delims = ['|',';',' vs ',' VS ',' or ',' OR ','?'];
  const detected = delims.some(d => qInput.value.includes(d));
  info.classList.toggle('d-none', !detected);
  manual.style.display = detected ? 'none' : 'block';
});
function showOptions(){
  const num = parseInt(document.getElementById('num_options').value || '2',10);
  const box = document.getElementById('options');
  box.innerHTML = '';
  for(let i=1;i<=num;i++){
    const div = document.createElement('div');
    div.className='mb-2';
    div.innerHTML = `<input type="text" class="form-control" name="option${i}" placeholder="Option ${i}" required>`;
    box.appendChild(div);
  }
}
showOptions();
</script>
</body>
</html>
